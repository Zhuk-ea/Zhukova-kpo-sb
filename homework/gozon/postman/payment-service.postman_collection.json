{
  "info": {
    "_postman_id": "payment-service-collection",
    "name": "Payment Service API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "API для управления платежами и счетами"
  },
  "item": [
    {
      "name": "Пополнить счет",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "X-User-Id",
            "value": "123",
            "description": "ID пользователя",
            "type": "text"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/payments/deposit?amount={{amount}}",
          "host": ["{{base_url}}"],
          "path": ["api", "payments", "deposit"],
          "query": [
            {
              "key": "amount",
              "value": "{{amount}}",
              "description": "Сумма для пополнения"
            }
          ]
        },
        "description": "Пополняет счет пользователя. Счет создается автоматически при первом обращении."
      },
      "response": []
    },
    {
      "name": "Получить баланс",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "X-User-Id",
            "value": "123",
            "description": "ID пользователя",
            "type": "text"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/payments/balance",
          "host": ["{{base_url}}"],
          "path": ["api", "payments", "balance"]
        },
        "description": "Возвращает текущий баланс пользователя"
      },
      "response": []
    },
    {
      "name": "Подготовка к тестированию (пополнение счета)",
      "item": [
        {
          "name": "Пополнить на 1000 рублей",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "X-User-Id",
                "value": "123",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/payments/deposit?amount=1000",
              "host": ["{{base_url}}"],
              "path": ["api", "payments", "deposit"],
              "query": [
                {
                  "key": "amount",
                  "value": "1000"
                }
              ]
            }
          }
        },
        {
          "name": "Пополнить на 5000 рублей",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "X-User-Id",
                "value": "123",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/payments/deposit?amount=5000",
              "host": ["{{base_url}}"],
              "path": ["api", "payments", "deposit"],
              "query": [
                {
                  "key": "amount",
                  "value": "5000"
                }
              ]
            }
          }
        },
        {
          "name": "Пополнить счет другого пользователя",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "X-User-Id",
                "value": "456",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/payments/deposit?amount=2000",
              "host": ["{{base_url}}"],
              "path": ["api", "payments", "deposit"],
              "query": [
                {
                  "key": "amount",
                  "value": "2000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Полный сценарий тестирования",
      "item": [
        {
          "name": "1. Проверить начальный баланс",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-User-Id",
                "value": "123",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/payments/balance",
              "host": ["{{base_url}}"],
              "path": ["api", "payments", "balance"]
            }
          }
        },
        {
          "name": "2. Пополнить счет",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "X-User-Id",
                "value": "123",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/payments/deposit?amount=3000",
              "host": ["{{base_url}}"],
              "path": ["api", "payments", "deposit"],
              "query": [
                {
                  "key": "amount",
                  "value": "3000"
                }
              ]
            }
          }
        },
        {
          "name": "3. Проверить баланс после пополнения",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-User-Id",
                "value": "123",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/payments/balance",
              "host": ["{{base_url}}"],
              "path": ["api", "payments", "balance"]
            }
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string",
      "description": "API Gateway URL"
    },
    {
      "key": "amount",
      "value": "1000",
      "type": "number",
      "description": "Сумма для пополнения"
    }
  ],
  "event": [
    {
      "listen": "test",
      "script": {
        "exec": [
          "// Тесты для Payment Service",
          "",
          "// Для пополнения счета",
          "if (pm.response.code === 200) {",
          "    pm.test(\"Счет успешно пополнен\", function() {",
          "        pm.response.to.have.status(200);",
          "        pm.response.to.have.body(\"Deposit successful\");",
          "    });",
          "}",
          "",
          "// Для получения баланса",
          "if (pm.response.code === 200) {",
          "    pm.test(\"Баланс получен\", function() {",
          "        pm.response.to.have.status(200);",
          "        pm.response.to.be.json;",
          "    });",
          "    ",
          "    var balance = parseFloat(pm.response.text());",
          "    console.log(\"Текущий баланс: \" + balance);",
          "}"
        ],
        "type": "text/javascript"
      }
    }
  ]
}